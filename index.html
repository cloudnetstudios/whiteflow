<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>whiteflow | online whiteboard</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>

  <style>

    /* Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', sans-serif;
    background-color: #f8faff;
    color: #333;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

.container {
    max-width: 100%;
    height: 100vh;
    display: flex;
    flex-direction: column;
}

/* Header Styles */
header {
    background-color: #ffffff;
    padding: 15px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    z-index: 10;
}

.logo {
    font-size: 24px;
    font-weight: 600;
    color: #4a86e8;
    letter-spacing: -0.5px;
}

.actions {
    display: flex;
    gap: 10px;
}

.btn {
    background-color: #e6f0ff;
    border: none;
    border-radius: 6px;
    padding: 8px 15px;
    font-family: 'Inter', sans-serif;
    font-weight: 600;
    font-size: 14px;
    color: #4a86e8;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 6px;
}

.btn:hover {
    background-color: #d1e3ff;
}

.btn i {
    font-size: 14px;
}

/* Toolbar Styles */
.toolbar {
    background-color: #ffffff;
    padding: 15px 25px;
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    border-bottom: 1px solid #e6f0ff;
}

.tool-group {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.tool {
    background-color: #f0f6ff;
    border-radius: 6px;
    padding: 8px 15px;
    font-size: 14px;
    font-weight: 600;
    color: #5a7ab8;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 6px;
}

.tool.active {
    background-color: #4a86e8;
    color: white;
}

.tool:hover:not(.active) {
    background-color: #e1ebff;
}

.tool i {
    font-size: 14px;
}

.tool-options {
    display: flex;
    gap: 20px;
    align-items: center;
    flex-wrap: wrap;
}

.size-option, .color-option, .font-option, .shape-option {
    display: flex;
    align-items: center;
    gap: 8px;
}

.size-option label, .color-option label, .font-option label, .shape-option label {
    font-size: 14px;
    font-weight: 600;
    color: #5a7ab8;
}

#size-slider {
    width: 100px;
    accent-color: #4a86e8;
}

#size-value {
    font-size: 14px;
    color: #5a7ab8;
    width: 40px;
}

#color-picker {
    width: 30px;
    height: 30px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    padding: 0;
}

.color-presets {
    display: flex;
    gap: 5px;
}

.color-preset {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    cursor: pointer;
    transition: transform 0.2s ease;
}

.color-preset:hover {
    transform: scale(1.2);
}

#font-select, #shape-select {
    padding: 5px 10px;
    border-radius: 4px;
    border: 1px solid #d1e3ff;
    background-color: #f0f6ff;
    font-family: 'Inter', sans-serif;
    font-size: 14px;
    color: #5a7ab8;
}

/* Canvas Styles */
.canvas-container {
    flex: 1;
    position: relative;
    background-color: #ffffff;
    overflow: hidden;
}

#whiteboard {
    position: absolute;
    top: 0;
    left: 0;
    cursor: crosshair;
    background-color: white;
}

/* Text Input Styles */
.text-input-container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
    z-index: 100;
    width: 300px;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

#text-input {
    width: 100%;
    height: 100px;
    padding: 10px;
    border-radius: 4px;
    border: 1px solid #d1e3ff;
    font-family: 'Inter', sans-serif;
    font-size: 14px;
    resize: none;
}

#add-text-btn, #cancel-text-btn {
    padding: 8px;
    border: none;
    border-radius: 4px;
    font-family: 'Inter', sans-serif;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s ease;
}

#add-text-btn {
    background-color: #4a86e8;
    color: white;
}

#add-text-btn:hover {
    background-color: #3a76d8;
}

#cancel-text-btn {
    background-color: #f0f0f0;
    color: #666;
}

#cancel-text-btn:hover {
    background-color: #e0e0e0;
}

/* Responsive Adjustments */
@media (max-width: 768px) {
    .toolbar {
        flex-direction: column;
    }
    
    .tool-group, .tool-options {
        width: 100%;
    }
}
    
  </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">whiteflow</div>
            <div class="actions">
                <button id="save-btn" class="btn"><i class="fas fa-save"></i> save</button>
                <button id="clear-btn" class="btn"><i class="fas fa-trash"></i> clear</button>
                <button id="undo-btn" class="btn"><i class="fas fa-undo"></i> undo</button>
            </div>
        </header>
        
        <div class="toolbar">
            <div class="tool-group">
                <div class="tool" data-tool="marker"><i class="fas fa-marker"></i> marker</div>
                <div class="tool" data-tool="pencil"><i class="fas fa-pencil-alt"></i> pencil</div>
                <div class="tool" data-tool="pen"><i class="fas fa-pen"></i> pen</div>
                <div class="tool" data-tool="eraser"><i class="fas fa-eraser"></i> eraser</div>
                <div class="tool" data-tool="text"><i class="fas fa-font"></i> text</div>
                <div class="tool" data-tool="shape"><i class="fas fa-shapes"></i> shapes</div>
            </div>
            
            <div class="tool-options">
                <div class="size-option">
                    <label for="size-slider">size:</label>
                    <input type="range" id="size-slider" min="1" max="50" value="5">
                    <span id="size-value">5px</span>
                </div>
                
                <div class="color-option">
                    <label for="color-picker">color:</label>
                    <input type="color" id="color-picker" value="#4a86e8">
                    <div class="color-presets">
                        <div class="color-preset" style="background-color: #4a86e8;"></div>
                        <div class="color-preset" style="background-color: #ff6b6b;"></div>
                        <div class="color-preset" style="background-color: #50c878;"></div>
                        <div class="color-preset" style="background-color: #ffd700;"></div>
                        <div class="color-preset" style="background-color: #9370db;"></div>
                        <div class="color-preset" style="background-color: #000000;"></div>
                    </div>
                </div>
                
                <div class="font-option" style="display: none;">
                    <label for="font-select">font:</label>
                    <select id="font-select">
                        <option value="Inter">inter</option>
                        <option value="Arial">arial</option>
                        <option value="Helvetica">helvetica</option>
                        <option value="Times New Roman">times new roman</option>
                        <option value="Courier New">courier new</option>
                    </select>
                </div>
                
                <div class="shape-option" style="display: none;">
                    <label for="shape-select">shape:</label>
                    <select id="shape-select">
                        <option value="rectangle">rectangle</option>
                        <option value="circle">circle</option>
                        <option value="line">line</option>
                        <option value="triangle">triangle</option>
                        <option value="arrow">arrow</option>
                    </select>
                </div>
            </div>
        </div>
        
        <div class="canvas-container">
            <canvas id="whiteboard"></canvas>
        </div>
        
        <div class="text-input-container" style="display: none;">
            <textarea id="text-input" placeholder="enter text here..."></textarea>
            <button id="add-text-btn">add text</button>
            <button id="cancel-text-btn">cancel</button>
        </div>
    </div>

  <script>

    // canvas setup
const canvas = document.getElementById('whiteboard');
const ctx = canvas.getContext('2d');
const container = document.querySelector('.canvas-container');

// resize canvas to fit container
function resizeCanvas() {
    canvas.width = container.clientWidth;
    canvas.height = container.clientHeight;
}

// initialize canvas size
resizeCanvas();

// handle window resize
window.addEventListener('resize', resizeCanvas);

// drawing state variables
let isDrawing = false;
let lastX = 0;
let lastY = 0;
let currentTool = 'marker';
let currentColor = '#4a86e8';
let currentSize = 5;
let currentFont = 'Inter';
let currentShape = 'rectangle';
let drawingHistory = [];
let currentStep = -1;
let textPosition = { x: 0, y: 0 };
let shapeStartPosition = { x: 0, y: 0 };

// tool elements
const tools = document.querySelectorAll('.tool');
const sizeSlider = document.getElementById('size-slider');
const sizeValue = document.getElementById('size-value');
const colorPicker = document.getElementById('color-picker');
const colorPresets = document.querySelectorAll('.color-preset');
const fontSelect = document.getElementById('font-select');
const shapeSelect = document.getElementById('shape-select');
const fontOption = document.querySelector('.font-option');
const shapeOption = document.querySelector('.shape-option');
const textInputContainer = document.querySelector('.text-input-container');
const textInput = document.getElementById('text-input');
const addTextBtn = document.getElementById('add-text-btn');
const cancelTextBtn = document.getElementById('cancel-text-btn');

// action buttons
const saveBtn = document.getElementById('save-btn');
const clearBtn = document.getElementById('clear-btn');
const undoBtn = document.getElementById('undo-btn');

// save current canvas state to history
function saveState() {
    // limit history size to prevent memory issues
    if (currentStep < drawingHistory.length - 1) {
        drawingHistory.splice(currentStep + 1);
    }
    
    currentStep++;
    const state = canvas.toDataURL();
    drawingHistory.push(state);
    
    // enable/disable undo button
    undoBtn.disabled = currentStep <= 0;
}

// restore canvas to a specific state
function restoreState(step) {
    if (step < 0 || step >= drawingHistory.length) return;
    
    currentStep = step;
    const img = new Image();
    img.onload = function() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, 0, 0);
    };
    img.src = drawingHistory[step];
    
    // enable/disable undo button
    undoBtn.disabled = currentStep <= 0;
}

// initialize canvas with a blank state
function initCanvas() {
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    saveState();
}

// set up drawing styles based on current tool
function setupDrawingStyle() {
    ctx.strokeStyle = currentColor;
    ctx.fillStyle = currentColor;
    ctx.lineWidth = currentSize;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    
    switch(currentTool) {
        case 'marker':
            ctx.globalAlpha = 0.6;
            break;
        case 'pencil':
            ctx.globalAlpha = 0.8;
            break;
        case 'pen':
        case 'shape':
            ctx.globalAlpha = 1;
            break;
        case 'eraser':
            ctx.globalAlpha = 1;
            ctx.strokeStyle = '#ffffff';
            break;
    }
}

// drawing functions for different tools
function draw(e) {
    if (!isDrawing) return;
    
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    
    setupDrawingStyle();
    
    switch(currentTool) {
        case 'marker':
        case 'pencil':
        case 'pen':
        case 'eraser':
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(x, y);
            ctx.stroke();
            break;
        case 'shape':
            // For shape preview, we'll redraw from the saved state
            if (currentStep >= 0) {
                restoreState(currentStep);
            } else {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
            
            drawShape(shapeStartPosition.x, shapeStartPosition.y, x, y);
            break;
    }
    
    lastX = x;
    lastY = y;
}

// draw different shapes
function drawShape(startX, startY, endX, endY) {
    setupDrawingStyle();
    
    switch(currentShape) {
        case 'rectangle':
            ctx.beginPath();
            ctx.rect(startX, startY, endX - startX, endY - startY);
            ctx.stroke();
            break;
        case 'circle':
            const radius = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
            ctx.beginPath();
            ctx.arc(startX, startY, radius, 0, Math.PI * 2);
            ctx.stroke();
            break;
        case 'line':
            ctx.beginPath();
            ctx.moveTo(startX, startY);
            ctx.lineTo(endX, endY);
            ctx.stroke();
            break;
        case 'triangle':
            ctx.beginPath();
            ctx.moveTo(startX, startY);
            ctx.lineTo(endX, endY);
            ctx.lineTo(startX - (endX - startX), endY);
            ctx.closePath();
            ctx.stroke();
            break;
        case 'arrow':
            const angle = Math.atan2(endY - startY, endX - startX);
            const headLength = 15;
            
            ctx.beginPath();
            ctx.moveTo(startX, startY);
            ctx.lineTo(endX, endY);
            ctx.lineTo(endX - headLength * Math.cos(angle - Math.PI / 6), endY - headLength * Math.sin(angle - Math.PI / 6));
            ctx.moveTo(endX, endY);
            ctx.lineTo(endX - headLength * Math.cos(angle + Math.PI / 6), endY - headLength * Math.sin(angle + Math.PI / 6));
            ctx.stroke();
            break;
    }
}

// add text to canvas
function addTextToCanvas() {
    const text = textInput.value.trim();
    if (!text) return;
    
    // restore previous state before adding text
    if (currentStep >= 0) {
        restoreState(currentStep);
    }
    
    ctx.globalAlpha = 1;
    ctx.fillStyle = currentColor;
    ctx.font = `${currentSize * 2}px ${currentFont}`;
    ctx.fillText(text, textPosition.x, textPosition.y);
    
    // save state after adding text
    saveState();
    
    // hide text input
    textInputContainer.style.display = 'none';
    textInput.value = '';
}

// event listeners for drawing
canvas.addEventListener('mousedown', (e) => {
    const rect = canvas.getBoundingClientRect();
    lastX = e.clientX - rect.left;
    lastY = e.clientY - rect.top;
    
    if (currentTool === 'text') {
        textPosition = { x: lastX, y: lastY };
        textInputContainer.style.display = 'flex';
        textInput.focus();
        return;
    }
    
    if (currentTool === 'shape') {
        shapeStartPosition = { x: lastX, y: lastY };
    }
    
    isDrawing = true;
});

canvas.addEventListener('mousemove', draw);

canvas.addEventListener('mouseup', () => {
    if (isDrawing && currentTool !== 'text') {
        isDrawing = false;
        saveState();
    }
});

canvas.addEventListener('mouseout', () => {
    if (isDrawing && currentTool !== 'text') {
        isDrawing = false;
        saveState();
    }
});

// tool selection
tools.forEach(tool => {
    tool.addEventListener('click', () => {
        // remove active class from all tools
        tools.forEach(t => t.classList.remove('active'));
        
        // add active class to selected tool
        tool.classList.add('active');
        
        // update current tool
        currentTool = tool.dataset.tool;
        
        // show/hide tool-specific options
        if (currentTool === 'text') {
            fontOption.style.display = 'flex';
            shapeOption.style.display = 'none';
        } else if (currentTool === 'shape') {
            fontOption.style.display = 'none';
            shapeOption.style.display = 'flex';
        } else {
            fontOption.style.display = 'none';
            shapeOption.style.display = 'none';
        }
    });
});

// set marker as default active tool
document.querySelector('[data-tool="marker"]').classList.add('active');

// size slider
sizeSlider.addEventListener('input', () => {
    currentSize = sizeSlider.value;
    sizeValue.textContent = `${currentSize}px`;
});

// color picker
colorPicker.addEventListener('input', () => {
    currentColor = colorPicker.value;
});

// color presets
colorPresets.forEach(preset => {
    preset.addEventListener('click', () => {
        const color = getComputedStyle(preset).backgroundColor;
        currentColor = rgbToHex(color);
        colorPicker.value = currentColor;
    });
});

// font selection
fontSelect.addEventListener('change', () => {
    currentFont = fontSelect.value;
});

// shape selection
shapeSelect.addEventListener('change', () => {
    currentShape = shapeSelect.value;
});

// text input buttons
addTextBtn.addEventListener('click', addTextToCanvas);
cancelTextBtn.addEventListener('click', () => {
    textInputContainer.style.display = 'none';
    textInput.value = '';
});

// save button
saveBtn.addEventListener('click', () => {
    const link = document.createElement('a');
    link.download = 'whiteflow-drawing.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
});

// clear button
clearBtn.addEventListener('click', () => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    saveState();
});

// undo button
undoBtn.addEventListener('click', () => {
    if (currentStep > 0) {
        restoreState(currentStep - 1);
    }
});

// helper function to convert rgb to hex
function rgbToHex(rgb) {
    // extract rgb values
    const rgbValues = rgb.match(/\d+/g);
    if (!rgbValues || rgbValues.length < 3) return '#000000';
    
    // convert to hex
    const r = parseInt(rgbValues[0]);
    const g = parseInt(rgbValues[1]);
    const b = parseInt(rgbValues[2]);
    
    return '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
}

// initialize canvas
initCanvas();

// disable undo button initially
undoBtn.disabled = true;

  </script>
    
    <script src="script.js"></script>
</body>
</html>
